
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Core Concepts Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-expand-active-chapter/expand-active-chapter.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        

    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="effects/" />
    
    
    <link rel="prev" href="./" />
    

<script src="https://unpkg.com/kotlin-playground"></script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2" data-path="core-concepts.html">
            
                <a href="core-concepts.html">
            
                    
                    Core Concepts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="effects/">
            
                <a href="effects/">
            
                    
                    Effects
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="effects/delay.html">
            
                <a href="effects/delay.html">
            
                    
                    Delay
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="effects/random.html">
            
                <a href="effects/random.html">
            
                    
                    Random
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="rendering.html">
            
                <a href="rendering.html">
            
                    
                    Rendering
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="oolong/">
            
                <a href="oolong/">
            
                    
                    API Reference
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="oolong/oolong/">
            
                <a href="oolong/oolong/">
            
                    
                    oolong
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1.1" data-path="oolong/oolong/-oolong/">
            
                <a href="oolong/oolong/-oolong/">
            
                    
                    Oolong
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1.1.1" data-path="oolong/oolong/-oolong/-main/">
            
                <a href="oolong/oolong/-oolong/-main/">
            
                    
                    Main
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1.1.1.1" data-path="oolong/oolong/-oolong/-main/program.html">
            
                <a href="oolong/oolong/-oolong/-main/program.html">
            
                    
                    program
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.1.1.2" data-path="oolong/oolong/-oolong/-main/runtime.html">
            
                <a href="oolong/oolong/-oolong/-main/runtime.html">
            
                    
                    runtime
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.1.1.2" data-path="oolong/oolong/-oolong/program.html">
            
                <a href="oolong/oolong/-oolong/program.html">
            
                    
                    program
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.1.3" data-path="oolong/oolong/-oolong/runtime.html">
            
                <a href="oolong/oolong/-oolong/runtime.html">
            
                    
                    runtime
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.1.2" data-path="oolong/oolong/-program/">
            
                <a href="oolong/oolong/-program/">
            
                    
                    Program
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1.2.1" data-path="oolong/oolong/-program/init.html">
            
                <a href="oolong/oolong/-program/init.html">
            
                    
                    init
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.2.2" data-path="oolong/oolong/-program/update.html">
            
                <a href="oolong/oolong/-program/update.html">
            
                    
                    update
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.2.3" data-path="oolong/oolong/-program/view.html">
            
                <a href="oolong/oolong/-program/view.html">
            
                    
                    view
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.1.3" data-path="oolong/oolong/-dispatch.html">
            
                <a href="oolong/oolong/-dispatch.html">
            
                    
                    Dispatch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.4" data-path="oolong/oolong/-dispose.html">
            
                <a href="oolong/oolong/-dispose.html">
            
                    
                    Dispose
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.5" data-path="oolong/oolong/-effect.html">
            
                <a href="oolong/oolong/-effect.html">
            
                    
                    Effect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.6" data-path="oolong/oolong/-init.html">
            
                <a href="oolong/oolong/-init.html">
            
                    
                    Init
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.7" data-path="oolong/oolong/-next.html">
            
                <a href="oolong/oolong/-next.html">
            
                    
                    Next
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.8" data-path="oolong/oolong/-render.html">
            
                <a href="oolong/oolong/-render.html">
            
                    
                    Render
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.9" data-path="oolong/oolong/-update.html">
            
                <a href="oolong/oolong/-update.html">
            
                    
                    Update
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.10" data-path="oolong/oolong/-view.html">
            
                <a href="oolong/oolong/-view.html">
            
                    
                    View
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="oolong/oolong.util.delay/">
            
                <a href="oolong/oolong.util.delay/">
            
                    
                    oolong.util.delay
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.2.1" data-path="oolong/oolong.util.delay/interval.html">
            
                <a href="oolong/oolong.util.delay/interval.html">
            
                    
                    interval
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.2" data-path="oolong/oolong.util.delay/timeout.html">
            
                <a href="oolong/oolong.util.delay/timeout.html">
            
                    
                    timeout
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="oolong/oolong.util.effect/">
            
                <a href="oolong/oolong.util.effect/">
            
                    
                    oolong.util.effect
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.3.1" data-path="oolong/oolong.util.effect/batch-effects.html">
            
                <a href="oolong/oolong.util.effect/batch-effects.html">
            
                    
                    batchEffects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.2" data-path="oolong/oolong.util.effect/no-effect.html">
            
                <a href="oolong/oolong.util.effect/no-effect.html">
            
                    
                    noEffect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.3" data-path="oolong/oolong.util.effect/without-effects.html">
            
                <a href="oolong/oolong.util.effect/without-effects.html">
            
                    
                    withoutEffects
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="oolong/oolong.util.random/">
            
                <a href="oolong/oolong.util.random/">
            
                    
                    oolong.util.random
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.4.1" data-path="oolong/oolong.util.random/next-bits.html">
            
                <a href="oolong/oolong.util.random/next-bits.html">
            
                    
                    nextBits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.2" data-path="oolong/oolong.util.random/next-boolean.html">
            
                <a href="oolong/oolong.util.random/next-boolean.html">
            
                    
                    nextBoolean
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.3" data-path="oolong/oolong.util.random/next-bytes.html">
            
                <a href="oolong/oolong.util.random/next-bytes.html">
            
                    
                    nextBytes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.4" data-path="oolong/oolong.util.random/next-double.html">
            
                <a href="oolong/oolong.util.random/next-double.html">
            
                    
                    nextDouble
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.5" data-path="oolong/oolong.util.random/next-float.html">
            
                <a href="oolong/oolong.util.random/next-float.html">
            
                    
                    nextFloat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.6" data-path="oolong/oolong.util.random/next-int.html">
            
                <a href="oolong/oolong.util.random/next-int.html">
            
                    
                    nextInt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.7" data-path="oolong/oolong.util.random/next-long.html">
            
                <a href="oolong/oolong.util.random/next-long.html">
            
                    
                    nextLong
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.8" data-path="oolong/oolong.util.random/next-u-bytes.html">
            
                <a href="oolong/oolong.util.random/next-u-bytes.html">
            
                    
                    nextUBytes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.9" data-path="oolong/oolong.util.random/next-u-int.html">
            
                <a href="oolong/oolong.util.random/next-u-int.html">
            
                    
                    nextUInt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.10" data-path="oolong/oolong.util.random/next-u-long.html">
            
                <a href="oolong/oolong.util.random/next-u-long.html">
            
                    
                    nextULong
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="oolong/alltypes.html">
            
                <a href="oolong/alltypes.html">
            
                    
                    all types
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Core Concepts</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="core-concepts">Core Concepts</h1>
<p>Let&apos;s visit each of the core concepts by examining a simple example. We&apos;ll create a simple &quot;counter&quot; program that can increment and decrement an <code>Int</code> state. In MVU architecture, state is changed by dispatching and handling messages. We&apos;ll look at this more in a moment. First let&apos;s take a look at the model.</p>
<h2 id="model">Model</h2>
<p>The model is a representation of the state of your application. In this case, the model contains just one property which is an <code>Int</code> named <code>count</code> with a default value of <code>0</code>. By convention, we define the model as a <code>data</code> class so it can be mutated easily. While your application is running, the model will be changing from one state to the next every time a message is dispatched.</p>
<pre><code class="lang-kotlin">data <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Model</span></span>(
    <span class="hljs-variable"><span class="hljs-keyword">val</span> count</span>: <span class="hljs-keyword">Int</span> = <span class="hljs-number">0</span>
)
</code></pre>
<h2 id="update">Update</h2>
<h4 id="messages">Messages</h4>
<p>Before looking at the update function, let&apos;s talk about messages. Messages describe the way we want the application state to change. In the case of our counter app, we have two messages that can be dispatched and handled: <code>Increment</code> and <code>Decrement</code>. <code>Increment</code> adds <code>1</code> to the current value of <code>count</code> and <code>Decrement</code> subtracts <code>1</code> from <code>count</code>. By convention, messages are defined as part of a <code>sealed</code> class. This allows us to use an exhaustive list of types when interpreting messages.</p>
<pre><code class="lang-kotlin">sealed <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Msg</span> </span>{
    <span class="hljs-keyword">object</span> Increment : Msg()
    <span class="hljs-keyword">object</span> Decrement : Msg()
}
</code></pre>
<h4 id="update-function">Update function</h4>
<p>The update function uses these two concepts to take a previous state and transform it to the next state. When a message is dispatched, the update function is called with the dispatched message and the current state as arguments. The function must determine what state to return given these arguments.</p>
<p>So far we have mentioned two conventions: models are <code>data</code> classes, and messages are <code>sealed</code> classes. You can see in the function below how those modifiers are leveraged. The message type is able to be determined in an exhaustive manner using the <code>when</code> block. The new state is created by mutating the old state with the <code>copy</code> function.</p>
<pre><code class="lang-kotlin"><span class="hljs-variable"><span class="hljs-keyword">val</span> update</span>: Update<span class="hljs-type">&lt;Model, Msg&gt;</span> = { msg, model -&gt;
    <span class="hljs-keyword">when</span> (msg) {
        Msg.Increment -&gt; model.copy(count = model.count + <span class="hljs-number">1</span>)
        Msg.Decrement -&gt; model.copy(count = model.count - <span class="hljs-number">1</span>)
    }
}
</code></pre>
<h2 id="view">View</h2>
<p>The job of the view function is to transform the current state into something that can be rendered in a UI. This could be an HTML string, a tree of widgets, or in multiplatform projects it will be a simple data structure. We call this output type view properties or <code>Props</code>.</p>
<h4 id="view-properties">View properties</h4>
<p>There are two types of data you may want to store in your view properties. First is information that you want to be rendered to the UI, and in this case we want to show the current count. The second category of data is message generators. Your rendering code will know how to display properties and dispatch messages created from generators. If you are only targetting one platform, then you may decide to return components specific to that platform, but since Oolong is a multiplatform library it is convention to use a hierarchical data structure.</p>
<pre><code class="lang-kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Props</span></span>(
    <span class="hljs-variable"><span class="hljs-keyword">val</span> count</span>: <span class="hljs-keyword">Int</span>,
    <span class="hljs-variable"><span class="hljs-keyword">val</span> onIncrement</span>: () -&gt; Msg,
    <span class="hljs-variable"><span class="hljs-keyword">val</span> onDecrement</span>: () -&gt; Msg
)
</code></pre>
<h4 id="view-function">View function</h4>
<p>The view function, as mentioned above, takes the current state its argument and returns view properties. In our counter example we populate the view properties with:</p>
<ul>
<li><code>count</code> - the current count.</li>
<li><code>onIncrement</code> - a function which returns the <code>Increment</code> message.</li>
<li><code>onDecrement</code> - a function which returns the <code>Decrement</code> message.</li>
</ul>
<pre><code class="lang-kotlin"><span class="hljs-variable"><span class="hljs-keyword">val</span> view</span>: View<span class="hljs-type">&lt;Model, Props&gt;</span> = { model -&gt;
    Props(
        model.count,
        { Msg.Increment },
        { Msg.Decrement }
    )
}
</code></pre>
<h2 id="puting-it-all-together">Puting it all together</h2>
<p>Now that we&apos;ve built the core components of our application we need a few more things to complete it, namely a way to create an initial application state and a way to render the view properties.</p>
<h4 id="initialization-function">Initialization function</h4>
<p>To get the runtime loop started, we first need to know what the initial state is. We do this by definiting an initialization function. This function is similar to the <code>update</code> function, however it takes no arguments. By convention, it is often desireable to define defaults in the model class and simply return a new instance from the init function.</p>
<pre><code class="lang-kotlin"><span class="hljs-variable"><span class="hljs-keyword">val</span> init</span>: Init<span class="hljs-type">&lt;Model&gt;</span> = {
    Model()
}
</code></pre>
<h4 id="render-function">Render function</h4>
<p>We also need to know how to render the view properties returned by the view function. Each target platform does this by implementing a render function which takes the view properties and a dispatch function as arguments. The dispatch function can be invoked to send messages to the update function.</p>
<pre><code class="lang-kotlin"><span class="hljs-variable"><span class="hljs-keyword">val</span> render</span>: Render<span class="hljs-type">&lt;Msg, Props&gt;</span> = { props, dispatch -&gt;
    <span class="hljs-comment">// Platform specific rendering</span>
    countLabel.text = <span class="hljs-string">&quot;${props.count}&quot;</span>
    incrementButton.setOnClickListener { dispatch(props.onIncrement()) }
    decrementButton.setOnClickListener { dispatch(props.onDecrement()) }
}
</code></pre>
<h4 id="runtime">Runtime</h4>
<p>The Oolong runtime composes these core functions into a user interaction loop, continually moving from one state to the next. It also handles things like side-effects (which we&apos;ll see in the next chapter) and resource disposal. You can start this loop by calling <code>Oolong.runtime</code>.</p>
<pre><code class="lang-kotlin"><span class="hljs-variable"><span class="hljs-keyword">val</span> dispose</span> = Oolong.runtime(
    init,
    update,
    view,
    render
)
</code></pre>
<p>Next, let&apos;s learn about <a href="effects/">Effects</a>.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Introduction">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="effects/" class="navigation navigation-next " aria-label="Next page: Effects">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Core Concepts","level":"1.2","depth":1,"next":{"title":"Effects","level":"1.3","depth":1,"path":"effects/README.md","ref":"effects/README.md","articles":[{"title":"Delay","level":"1.3.1","depth":2,"path":"effects/delay.md","ref":"effects/delay.md","articles":[]},{"title":"Random","level":"1.3.2","depth":2,"path":"effects/random.md","ref":"effects/random.md","articles":[]}]},"previous":{"title":"Introduction","level":"1.1","depth":1,"path":"README.md","ref":"README.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["expand-active-chapter","kotlin-playground@https://github.com/pardom/gitbook-plugin-kotlin-playground"],"pluginsConfig":{"expand-active-chapter":{},"kotlin-playground":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"core-concepts.md","mtime":"2019-03-20T16:09:57.374Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-03-20T18:54:13.286Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-expand-active-chapter/expand-active-chapter.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-kotlin-playground/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

